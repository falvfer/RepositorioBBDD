create domain d_id integer;
create domain d_nif  varchar(10);
create domain d_cadena20  varchar(20);
create domain d_cadena40  varchar(40);
create domain d_cadena60  varchar(60);
create domain d_cadena80  varchar(80);
create domain d_entero int;

create domain d_fecha date;
create domain d_dinero decimal (9,2);

create domain d_Boolean  boolean;
create domain d_porcentaje decimal(5,2);

create table aficionados (
	id_aficionado d_id generated by default as IDENTITY,
    nif d_nif not null,
    nombre d_cadena40 not NULL,
    direccion D_CADENA80 not null, 
    poblacion d_cadena40 not null,
    total_importe d_dinero not null
);


alter table aficionados add constraint pk_aficionados primary key (id_aficionado);

insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('11111111A', 'Luis', 'C/ Plato 12', 'Antequera',0);
commit;

insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('21111111A', 'Luis', 'C/ Plato 12', 'Antequera',0);

insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('31111111A', 'Luisa', 'C/ Plato 1', 'Antequera',0);
insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('41111111A', 'Maria', 'C/ Ejido 12', 'Estepa',0);
insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('51111111A', 'Reca', 'C/ Nueva 12', 'Málaga',0);
insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('61111111A', 'Andres', 'C/ Jaen 12', 'Campillos',0);
insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('71111111A', 'Jacinto', 'C/ Archidona 12', 'Archidona',0);
insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('81111111A', 'Felipe', 'C/ Purisima 12', 'Loja',0);
insert into aficionados (nif, nombre, direccion, poblacion, total_importe)
	values ('91111111A', 'Manuel', 'C/ Fria 12', 'Antequera',0);
commit;

select *
	from aficionados;
    
create table maestros (
	id_maestro d_id generated by default as IDENTITY,
    id_aficionado d_id not null,
    fecha_alta d_fecha not null
);

alter table maestros add constraint pk_maestros primary key (id_maestro);

alter table maestros add constraint fk_maestros_aficionados 
	foreign key (id_aficionado) references aficionados(id_aficionado)
    on delete no ACTION
    on update cascade;
    
alter table maestros add constraint u_maestros_01 unique (id_aficionado);
    
    
insert into maestros (id_aficionado, fecha_alta)
   values (1, '2001-01-23');
   
commit;

insert into maestros (id_aficionado, fecha_alta)
   values (2, '2002-01-23');

insert into maestros (id_aficionado, fecha_alta)
   values (3, '2003-01-23');
   
insert into maestros (id_aficionado, fecha_alta)
   values (6, '2006-01-23');

insert into maestros (id_aficionado, fecha_alta)
   values (7, '2007-01-23');
commit;

create table bonsais (
	id_bonsai d_id generated by default as identity,
	id_aficionado d_id not null,
    id_maestro d_id not null,
    especie d_cadena40 not null,
    descripcion d_cadena60 not null,
    fecha_plantacion d_fecha not null,
    fecha_inscripcion d_fecha not null
);

alter table bonsais add constraint pk_bonsais primary key (id_bonsai);

alter table bonsais add constraint fk_bonsais_aficionados foreign key (id_aficionado)
                   references AFICIONADOS(id_aficionado)
                   on delete no action
                   on update cascade;
                   
alter table bonsais add constraint fk_bonsais_maestros foreign key (id_maestro)
                   references maestros(id_maestro)
                     on delete no action
                   on update cascade;
                   
                   
insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (1,1, 'olivo acebuche', 'Olivo acebuche tres pies', '2019-01-03', '2019-03-05');
commit;


insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (1,1, 'olivo gordal', 'Olivo acebuche tres pies', '2019-01-03', '2019-03-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (2,2, 'olivo hojiblanco', 'Olivo acebuche tres pies', '2019-01-03', '2019-03-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (1,3, 'higuera', 'higuera breva blanca', '2020-01-03', '2020-06-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (2,1, 'alamo', 'alamo negro', '2020-02-03', '2020-08-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (1,2, 'almendro', 'almendro marconi', '2020-01-03', '2020-07-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (2,3, 'peral', 'pera limonera', '2021-01-03', '2021-04-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (3,1, 'manzano', 'manzano rojo', '2021-01-03', '2021-06-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (1,2, 'naranjo', 'Navelina', '2021-01-03', '2021-07-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (2,3, 'membrillo', 'Gamboo', '2022-01-03', '2022-03-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (3,1, 'granado', 'granado blanco', '2022-01-03', '2023-03-05');
commit;

insert into bonsais (id_aficionado, id_maestro, especie, descripcion, fecha_plantacion, fecha_inscripcion)
 values (4,2, 'olivo ', 'Olivo verde', '2022-01-03', '2023-03-05');
commit;


select *
	from bonsais;
    
    
create table cuotas (
	id_cuota d_id generated by default as IDENTITY,
    id_aficionado d_id not null,
    fecha_cuota d_fecha not null,
    fecha_pago d_fecha,
    importe d_dinero not null
);


alter table cuotas add constraint pk_cuotas primary key (id_cuota);

alter table cuotas add constraint fk_cuotas_aficionado foreign key (id_aficionado)
	references aficionados(id_aficionado)
    on delete no ACTION
    on update cascade;
    
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (1, '2020-01-01', '2020-02-01', 20);
commit;

insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (2, '2020-01-01', '2020-02-01', 20);

insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (3, '2020-01-01', '2020-02-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (4, '2020-01-01', '2020-02-01', 20);
    
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (1, '2021-02-01', '2020-03-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (2, '2021-03-01', '2021-04-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (3, '2021-04-01', '2021-05-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (4, '2021-05-01', '2020-06-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (1, '2022-01-01', '2022-02-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (2, '2022-02-01', '2022-03-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (3, '2022-02-01', '2022-03-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (4, '2022-02-01', '2022-03-01', 20);
    
insert into cuotas (id_aficionado, fecha_cuota, fecha_pago, importe)
	values (1, '2023-01-01', '2023-02-01', 20);
    
commit;

select *
	from cuotas;